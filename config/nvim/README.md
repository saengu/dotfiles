# Introduction

These are lua config files for neovim >= 0.11 based on mini.nvim packages.

# Add Language Server

Use `nvim-lspconfig` plugin to provide language server configurations and built-in `vim.lsp.enable`
function to activate language server. Refer to `nvim-lspconfig` home page for more information.

```
vim.lsp.enable('<language_server_name>')

# Or multiple language servers

vim.lsp.enable({'<language_server_name1>', '<language_server_name2>', ... })
```


# TreeSitter

## Inspect Tree

You can use :InspectTree inside a file for a language you have installed a parser for and see the syntax tree nodes generated by treesitter and the parser.

```
:InspectTree
```

## Keymap not work
If keymaps config by setup function not work, as Treesitter uses a different parser for every language, please check whether the language parser installed or not.

Use below command to get a list of all available languages and their installation status.

```
:TSInstallInfo
```

 Parsers not on this list can be added manually by following the command:

```
:TSInstall <language_to_install>
```

# Keymaps

## Completions

File path like `/` or `$HOME`  or `$HOME/` press `<C-x><C-f>` will pop candidates with path provider.

Update `blink.cmp` config at runtime.
`
:lua require('blink.cmp.config').completion.documentation.auto_show=false
`

## LSP

format code: normal mode press `=`
show function document normal mode press `K`


Show all key maps by command `:map`
Inspect key binding of single keymap `:imap <C-k>`


delete keymap
```
-- Delete a normal mode keymap for <Leader>D
vim.keymap.del("n", "<Leader>D")

-- Delete an insert mode keymap for <C-c>
vim.keymap.del("i", "<C-c>")

-- Delete a buffer-local keymap (requires the 'buffer' option to be set when deleting)
-- Example if the original was set with { buffer = true }
vim.keymap.del("n", "<Leader>L", { buffer = true })
```

show signature help <C-s>, normal insert mode, rust put cursor on argument in bracket or right bracket if function requires no argument, golang put on bracket.
show document `K` normal mode, <C-k> both insert and normal mode. `C-<Space>` for completion menu item.

paste from system clipboard normal mode `<Space>p`, insert mode use system keymap `<C-v>`.
copy to system clipboard normal mode `<Space>y`

the substitude command `s` not work as it conflicts with `mini.surround` and disabled in `mini.surround` config.

## Telescope

When picker is opened, press <C-/> to show which-key style keymap window.

# Cookbook

## Support Formatting on Save
Formatting on save is a popular workflow and is built into many text editors and IDEs.

In Neovim, you must create this manually, but it is very easy using autocmds.

```
-- 1
vim.api.nvim_create_autocmd("LspAttach", {
  group = vim.api.nvim_create_augroup("lsp", { clear = true }),
  callback = function(args)
    -- 2
    vim.api.nvim_create_autocmd("BufWritePre", {
      -- 3
      buffer = args.buf,
      callback = function()
        -- 4 + 5
        vim.lsp.buf.format {async = false, id = args.data.client_id }
      end,
    })
  end
})
```

1. We create a new autocmd that fires on the LspAttach event. This event is fired when an LSP client attaches to a buffer. In this autocmd, you can easily set configuration that is specific to that buffer and LSP client.
2. We create another autcmd inside the LspAttach callback, this time for the BufWritePre event. This fires when you save the buffer but before it flushes anything to disk. This gives you a chance to manipulate the buffer first.
3. We configure this autocmd to only execute for the current buffer. This is a little more straight forward rather than setting an autocmd that executes for any range of file types.
4. In the callback, we run vim.lsp.buf.format to format the buffer, with the flag async = false. This ensures that the formatting request will block until it completes, so that it completely finishes formatting before flushing the file to disk.
5. We also set the id = args.data.client flag so that the formatting request is only sent to the LSP client that is related to the outer LspAttach request. This ensures that we aren't running the formatting request multiple times in case the buffer is attached to multiple LSPs.

And there we have it, modern format on save for those who want it.

Reference: https://www.mitchellhanberg.com/modern-format-on-save-in-neovim/


## help
`:help` is a command that navigates a set of help files. For instance, if we wanted to learn how to
search for a string in Vim, we could try using the following `:h search`. However, it looks like this command takes us to the entry on expression evaluation, which is not
exactly what we were looking for. To find the right entry, type :h search (don’t hit Enter yet) followed by Ctrl + d. This will give you a
list of help tags containing the search substring. One of the options shown is `search-commands`, which is what we’d be looking for.

Navigating search files
A discerning reader might notice certain keywords adorned with various characters ([, {, |,
etc.) or highlighted (depending on your color scheme) in help pages. When your cursor is over
a keyword in a help file, you can press Ctrl + ] to jump to the definition of the keyword, and
Ctrl + o to jump back. Give it a shot!

## Adjust window size
 respective width commands: 20<c-w>| ("pipe" symbol - statically set width to 20 - without a number it will maximize it) and 20<c-w>< (decrease width of current window by 20) and 20<c-w>>



The Ctrl-W+ shortcut takes a preceding count. The Ctrl-W_ command maximizes the window without a count, or sets absolute height with a preceding count. Using counts, you should rarely have to do repeated window resizing commands.

If you do find yourself frequently wanting to make small repeated adjustments to window sizes, maybe you could take advantage of the repeatability of ex-commands (with @:) and resize with :resize +1 instead of the keyboard shortcut.

After pressing @: once, you can then press @@ multiple times (it means something like: execute the command in the last used buffer) // ADDITIONALLY respective shortcuts for width are: <c-w>| (maximizes or sets absolute width) and <c-w>< or <c-w>> (to de-/increase width) and <c-w>= to equalize.
@: repeats the last command line cmd, @@ repeats the previous cmdline/macro/keybind.

## Reference:

1. https://github.com/nvim-treesitter/nvim-treesitter
2. https://github.com/nvim-treesitter/nvim-tree-docs
3. https://github.com/nvim-treesitter/nvim-treesitter-textobjects
4. https://www.josean.com/posts/nvim-treesitter-and-textobjects

